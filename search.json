[
  {
    "objectID": "posts/statsmodel-library/statsmodel-library.html",
    "href": "posts/statsmodel-library/statsmodel-library.html",
    "title": "The statsmodel Python Library",
    "section": "",
    "text": "When thinking about a data science project, one of the first decisions I find myself having to make is which language I want to do the project with. My first two choices are generally R or Python. Both languages have the capabilities to do high level data science work, but each has its pros and cons as well."
  },
  {
    "objectID": "posts/statsmodel-library/statsmodel-library.html#python",
    "href": "posts/statsmodel-library/statsmodel-library.html#python",
    "title": "The statsmodel Python Library",
    "section": "Python",
    "text": "Python\nPython is often one of the first languages a new programmer learns. Its syntax is intuitive and the language has become quite popular over recent years, in part because of the (community of open source libraries) that are easy to import to a script.\nA drawback to Python, however, is that it does not come built in with data frame capabilities and requires a third-party library (Pandas being the most popular) to structure data in a way that is easier to work with. You can structure data in lists, arrays, and dictionaries, but it requires a fair amount of code to get the data structured in a way you can work with it.\nFor how intuitive most of the language’s syntax is, visualizations are not the easiest to create either. Matplotlib is a popular library to create visualizations, but it is not as straightforward as some of the packages or built in capabilities available in R."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "bendemouth.github.io",
    "section": "",
    "text": "The statsmodel Python Library\n\n\n\n\n\n\nPython\n\n\nR\n\n\n\nComparing and contrasting the statsmodel library against standard R Language\n\n\n\n\n\nFeb 1, 2025\n\n\n\n\n\n\n\n\n\n\n\n\nA Look at the Thunder Defense\n\n\n\n\n\n\nNBA\n\n\nSports Analytics\n\n\n\nLooking at what makes the OKC Thunder successful on defenese\n\n\n\n\n\nFeb 13, 2024\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "posts/a-look-at-the-thunder-defense/a-look-at-the-thunder-defense.html",
    "href": "posts/a-look-at-the-thunder-defense/a-look-at-the-thunder-defense.html",
    "title": "A Look at the Thunder Defense",
    "section": "",
    "text": "The Oklahoma City Thunder are zigging while the rest of the NBA has gone head long into their zags.\nEver since Steph Curry and the Golden State Warriors brought on the three-point revolution in the mid 2010s, NBA teams across the board have built their teams around shooting and offensive efficiency. This season, NBA teams are shooting are shooting 37.5 three-pointers per game, about 42.1% of all field goals attempted. Before the Warriors one the first championship of their eventual dynasty in 2015, those numbers were 21.5 threes attempted per game for 25.9% of their field goal attempts, and 20 years ago teams shot just 15.8 threes per game, good for just 19.7% of their total field goal attempts. With that rise in efficient shot selection, league-wide offensive efficiency numbers have improved by 7.9 points per 100 possessions.\nAs any good old head will tell you, though, defense wins championships. The Thunder have taken that adage to heart this year and are smothering opponents on the defensive end of the floor. The strategy has them sitting atop the Western Conference and tied for the best record in the league."
  },
  {
    "objectID": "posts/a-look-at-the-thunder-defense/a-look-at-the-thunder-defense.html#understanding-the-three-point-revolution",
    "href": "posts/a-look-at-the-thunder-defense/a-look-at-the-thunder-defense.html#understanding-the-three-point-revolution",
    "title": "A Look at the Thunder Defense",
    "section": "Understanding the Three-Point Revolution",
    "text": "Understanding the Three-Point Revolution\nIn order to understand the Thunder’s response to the three-point revolution, we need to understand why teams started hunting these long-range shots in the first place. “But Ben, the three-point revolution is simple. Three is more than two, so it’s better. Also, this is a defensive blog, why are you writing about offense?” First off, props to your math teacher. Second, mind your business, we’ll get there.\nDespite what certain former NBA players would have you believe, the three-point revolution is not simply about taking shots that are more worth more than two-pointers. It is a response to defensive changes. In the 2000s, the NBA was all about getting your best player in a one-on-one matchup so they could drive to the hoop. Defenses started packing the paint to make those layups more difficult, freeing up perimeter shooters. Rather than taking a contested layup, teams could get better looks from three.\nThat doesn’t mean that teams do not want layups. Layups are still the first choice for any offense. Where the real change has come is in the choice between an open mid-range shot and an open three-pointer. Teams shoot rougly the same percentage from 10-22 feet as they do from 23 feet. Those 10-22 foot shots are only worth two, though, while going beyond 22’ 9” is worth three. So, if you can’t get a good layup, and you have a choice between a shot that is worth two and a shot that is worth three, knowing you make them at roughly the same clip, you’re going to take the three. The “three-point revolution” has never been about getting rid of layups. It answers the question of, “if I can’t get a good layup, what is my next best option?”"
  },
  {
    "objectID": "posts/a-look-at-the-thunder-defense/a-look-at-the-thunder-defense.html#the-thunder-make-teams-take-bad-shots",
    "href": "posts/a-look-at-the-thunder-defense/a-look-at-the-thunder-defense.html#the-thunder-make-teams-take-bad-shots",
    "title": "A Look at the Thunder Defense",
    "section": "The Thunder Make Teams Take Bad Shots",
    "text": "The Thunder Make Teams Take Bad Shots\nUnderstanding now why teams are taking and avoiding the shots they are, we can look at teams’ shot selection against the Thunder.\nUsing the NBA API, we can pull shot location data for the NBA.\n\nimport pandas as pd \nimport polars as pl\nimport nba_api.stats.endpoints as nba_endpoints\nfrom nba_api.stats.static import teams, players\nimport matplotlib.pyplot as plt\nfrom matplotlib.patches import Circle, Rectangle, Arc\nimport seaborn as sns\nimport plotly.express as px\n\nokc_id_string = \"1610612760\"\nokc_id_int = int(okc_id_string)\n\n# Shot data for teams against the Thunder\nthunder_defensive_shot_data = nba_endpoints.ShotChartDetail(\n    opponent_team_id=okc_id_string,\n    team_id=0,\n    player_id=0,\n    context_measure_simple=\"FGA\",\n).get_data_frames()[0]\n\n# Shot data for the whole league\nleague_shot_data = nba_endpoints.ShotChartDetail(\n    team_id=0,\n    player_id=0,\n    context_measure_simple=\"FGA\",\n).get_data_frames()[0]\n\n# Convert to Polars\nthunder_defensive_shot_data = pl.from_pandas(thunder_defensive_shot_data)\n\nleague_shot_data = pl.from_pandas(league_shot_data)\n\n# Filter out Thunder games\nleague_shot_data = league_shot_data.filter(\n    ~pl.col(\"GAME_ID\").is_in(thunder_defensive_shot_data['GAME_ID'])\n)\n\n\n# Get league shooting by zone\nleague_shooting_by_zone = league_shot_data.group_by('SHOT_ZONE_BASIC').agg(\n    FGA=pl.col('SHOT_ATTEMPTED_FLAG').count(),\n    FGM=pl.col('SHOT_MADE_FLAG').sum()\n).with_columns([\n    pl.col('FGA').alias('FGA_league'),\n    pl.col('FGM').alias('FGM_league')\n]).with_columns([\n    (pl.col('FGM_league') / pl.col('FGA_league')).alias('fg_pct_league'),\n    (pl.col('FGA_league') / 29).alias('fga_avg'),\n    (pl.col('FGM_league') / 29).alias('fgm_avg')\n])\n\n# Get Thunder opponents shooting by zone\nthunder_defense_by_zone = thunder_defensive_shot_data.group_by('SHOT_ZONE_BASIC').agg(\n    FGA=pl.col('SHOT_ATTEMPTED_FLAG').count(),\n    FGM=pl.col('SHOT_MADE_FLAG').sum()\n).with_columns(\n    fg_pct=pl.col('FGM') / pl.col('FGA')\n).rename({'fg_pct': 'fg_pct_thunder'})\n\ncomp_df = league_shooting_by_zone.join(thunder_defense_by_zone, on='SHOT_ZONE_BASIC', how='left', suffix='_thunder').with_columns(\n    fg_pct_diff = pl.col('fg_pct_league') - pl.col('fg_pct_thunder')\n).sort('fg_pct_diff', descending=True)\n\ncomp_df\n\n\nshape: (7, 12)\n\n\n\nSHOT_ZONE_BASIC\nFGA\nFGM\nFGA_league\nFGM_league\nfg_pct_league\nfga_avg\nfgm_avg\nFGA_thunder\nFGM_thunder\nfg_pct_thunder\nfg_pct_diff\n\n\nstr\nu32\ni64\nu32\ni64\nf64\nf64\nf64\nu32\ni64\nf64\nf64\n\n\n\n\n\"Left Corner 3\"\n7400\n2839\n7400\n2839\n0.383649\n255.172414\n97.896552\n290\n98\n0.337931\n0.045718\n\n\n\"Above the Break 3\"\n42091\n14883\n42091\n14883\n0.353591\n1451.413793\n513.206897\n1451\n459\n0.316334\n0.037257\n\n\n\"Restricted Area\"\n38247\n25339\n38247\n25339\n0.662509\n1318.862069\n873.758621\n1231\n771\n0.62632\n0.036189\n\n\n\"Mid-Range\"\n13474\n5565\n13474\n5565\n0.413018\n464.62069\n191.896552\n393\n149\n0.379135\n0.033883\n\n\n\"In The Paint (Non-RA)\"\n26946\n11824\n26946\n11824\n0.438804\n929.172414\n407.724138\n923\n386\n0.418202\n0.020602\n\n\n\"Backcourt\"\n335\n6\n335\n6\n0.01791\n11.551724\n0.206897\n13\n0\n0.0\n0.01791\n\n\n\"Right Corner 3\"\n6991\n2715\n6991\n2715\n0.388356\n241.068966\n93.62069\n308\n123\n0.399351\n-0.010994\n\n\n\n\n\n\nThis data frame shows us league totals for field goal shooting by zone, league averages (without the Thunder) by zone, and how teams perform against the Thunder in the same areas. I divided the league totals by 29, the number of NBA teams minus the Thunder, to get numbers for an “average” team. It is difficult to get a sense of scale when comparing league wide totals to numbers for a single team.\nAs we’ve established, teams want to get layups as frequently as possible. OKC does not allow teams to get those shots off. A typical NBA team has 1318.86 shots from within the restricted area at this point in the season, and the Thunder have allowed just 1231. And even when teams do get to the rim, they are not as effective at finishing those attempts. Teams shoot 3.6 percentage points lower at the rim against the Thunder than they do against the rest of the league.\nSo, if the secondary option is to shoot threes, a follow up question is, “what kind of three is best?” NBA analytics people will tell you that the corner three is the best three to take. The corner three is about a foot and a half closer to the basket than the rest of the arc, so teams prefer to take those if they can get them. What is shocking here is that the Thunder actually allow far more corner threes than league average, giving up 290 from the left corner and 308 from the right corner. Teams do shoot about 1.1 percentage points better than average from the right corner, but 4.6 percentage points worse than average from the left corner.\nHow is this possible?\n\nleague_hustle_data = nba_endpoints.LeagueHustleStatsTeam(\n    per_mode_time = \"PerGame\",\n    team_id_nullable = None\n)\n\nleague_hustle_data = league_hustle_data.get_data_frames()[0]\n\nleague_hustle_data = pl.from_pandas(league_hustle_data)\n\nthunder_hustle_data = league_hustle_data.filter(\n    pl.col(\"TEAM_ID\") == okc_id_int\n)\n\nleague_hustle_data = league_hustle_data.filter(\n    pl.col(\"TEAM_ID\") != okc_id_int\n)\n\nleague_box_data = nba_endpoints.LeagueDashPtTeamDefend(\n    defense_category = \"3 Pointers\",\n    per_mode_simple = \"PerGame\",\n    team_id_nullable = None\n)\n\nleague_box_data = league_box_data.get_data_frames()[0]\n\nleague_box_data = pl.from_pandas(league_box_data)\n\nthunder_box_data = league_box_data.filter(\n    pl.col(\"TEAM_ID\") == okc_id_int\n)\n\nleague_box_data = league_box_data.filter(\n    pl.col(\"TEAM_ID\") != okc_id_int\n)\n\nhustle_box_data = league_hustle_data.join(league_box_data, on='TEAM_ID', how='left').with_columns(\n    uncontested_threes_per_game = pl.col('FG3A') - pl.col('CONTESTED_SHOTS_3PT')\n).with_columns(\n    pct_uncontested_threes = pl.col('uncontested_threes_per_game') / pl.col('FG3A')\n)\n\nthunder_hustle_box_data = thunder_hustle_data.join(thunder_box_data, on='TEAM_ID', how='left').with_columns(\n    uncontested_threes_per_game = pl.col('FG3A') - pl.col('CONTESTED_SHOTS_3PT')\n).with_columns(\n    pct_uncontested_threes = pl.col('uncontested_threes_per_game') / pl.col('FG3A')\n)\n\n\nthunder_blue = \"#007ac1\"\nthunder_orange = \"#ef3b24\"\nthunder_yellow = \"#fdbb30\"\n\nplt.figure(figsize=(10,5))\nplt.title('Percentage of Uncontested 3-Pointers')\nplt.bar(hustle_box_data['TEAM_NAME'], hustle_box_data['pct_uncontested_threes'], color=thunder_blue)\nplt.bar(thunder_hustle_box_data['TEAM_NAME'], thunder_hustle_box_data['pct_uncontested_threes'], color=thunder_orange)\nplt.axhline(y=hustle_box_data['pct_uncontested_threes'].mean(), color=thunder_yellow, linestyle='--', label='League Average')\nplt.xticks(rotation=90)\nplt.show()\n\n\n\n\n\n\n\n\n\nscatter_data = pl.concat([hustle_box_data, thunder_hustle_box_data])\n\nscatter_data = scatter_data.with_columns(\n    pl.lit(\"Other\").alias(\"team_group\")  # First create column with all \"Other\"\n)\n\n# Then update just the Thunder rows\nscatter_data = scatter_data.with_columns(\n    pl.when(pl.col(\"TEAM_NAME\") == \"Oklahoma City Thunder\")\n    .then(pl.lit(\"Thunder\"))\n    .otherwise(pl.col(\"team_group\"))\n    .alias(\"team_group\")\n)\n\nfig = px.scatter(\n    data_frame=scatter_data,\n    x='FG3A',\n    y='pct_uncontested_threes',\n    hover_data=['TEAM_NAME'],\n    color='team_group',\n    color_discrete_map={\n        'Thunder': thunder_orange,\n        'Other' : thunder_blue\n    },\n\n)\n\nfig.update_layout(\n    title='Three Point Attempts vs Uncontested Percentage',\n    xaxis_title='Opponent Three Point Attempts per Game',\n    yaxis_title='Percentage of Uncontested 3s',\n    showlegend=False,\n    yaxis=dict(\n        tickformat='.1%'\n    )\n)\n\nfig.show()\n\nUnable to display output for mime type(s): application/vnd.plotly.v1+json\n\n\nWell, while the Thunder do allow a fair amount of threes, they don’t give up very many uncontested looks. OKC ranks second in the league for lowest percent of open three-point looks allowed, with only 51.4% of three point attempts being uncontested. Only Golden State are better at 50.8%, and the league average sits at 57%.\nFor me, this begs the question of, “if I am getting contested looks from deep and contested looks at the rim, why would I not just try the contested looks at the rim?”\nThe data tells me that are two reasons.\nThe first is chaos.\n\nplt.figure(figsize=(10, 5))\nplt.title('Deflections Per 48 Minutes')\nplt.bar(league_hustle_data['TEAM_NAME'], league_hustle_data['DEFLECTIONS'], color=thunder_blue)\nplt.bar(thunder_hustle_data['TEAM_NAME'], thunder_hustle_data['DEFLECTIONS'], color=thunder_orange)\nplt.axhline(league_hustle_data['DEFLECTIONS'].mean(), linestyle=\"--\", color=thunder_yellow)\nplt.ylabel('Deflections')\nplt.xticks(rotation=90)\nplt.show()\n\n\n\n\n\n\n\n\nOKC tip more balls than any other team in the league at 21.69 per 48 minutes, causing chaos when a team is trying to set up their offense. League average is 16.14.\nConsider a normal, uneventful NBA possession after a made shot. 24 seconds on the shot clock. The team inbounds the ball and brings the ball up the floor. 19 seconds on the shot clock. The point guard initiates the offensive play and the first option isn’t open. That’s okay, you still have 12 or 13 seconds on the shot clock. The offense rotates the ball, drives and kicks for an open jump shot. Whether they make or miss that shot isn’t relevant for our purposes, but they likely get that shot off with at least 5 seconds left on the shot clock.\nNow consider what happens against the Thunder.\nThe same inbound and walking of the ball up the court occurs. The point guard initiates the offense but the first pass is tipped. Now you have tos scramble to recover the ball, reset, and get back into an offensive set. Let’s say it takes 5 seconds to recover the ball and reset the offense. Now you aren’t even getting into an offensive set until about 14 seconds on the clock. If that first option isn’t open, there is very little time to rotate the ball, drive, and get a good shot off. The chaos of tipped balls doesn’t allow for teams to work for a better shot. After spending the time to get the ball back, teams just need to get a shot, any shot, up before the shot clock expires.\nWhat’s more is that the Thunder are very good at recovering those loose balls when they do get deflections.\n\nplt.figure(figsize=(10,5))\nplt.bar(league_hustle_data['TEAM_NAME'], league_hustle_data['PCT_LOOSE_BALLS_RECOVERED_DEF'], color=thunder_blue)\nplt.bar(thunder_hustle_data['TEAM_NAME'], thunder_hustle_data['PCT_LOOSE_BALLS_RECOVERED_DEF'], color=thunder_orange)\nplt.title(\"Percent of Defensive Loose Balls Recovered\")\nplt.axhline(league_hustle_data['PCT_LOOSE_BALLS_RECOVERED_DEF'].mean(), linestyle=\"--\", color = thunder_yellow)\nplt.xticks(rotation=90)\nplt.show()\n\n\n\n\n\n\n\n\nThe Thunder lead the NBA in this statistic as well, recovering 57.9% of loose balls on their defensive end of the floor. League average for this category is just 49.4%.\nI almost feel bad for the Thunder opponents.\nI remember growing up on the playground and playing Monkey in the Middle. There would always be one kid who was just bigger, faster, and more athletic than the rest of us. Whenever he would be the Monkey, it wasn’t even fun because he would just intercept the first pass the rest of us threw.\nHere are these grown men, professional athletes at the peak of their craft, just trying to play a basketball game. And the Thunder simply will not let them.\nThe second reason why teams might be hesitant to go at the rim is that OKC take charges better than anyone else in the league.\n\nplt.figure(figsize=(10,5))\nplt.bar(league_hustle_data['TEAM_NAME'], league_hustle_data['CHARGES_DRAWN'], color=thunder_blue)\nplt.bar(thunder_hustle_data['TEAM_NAME'], thunder_hustle_data['CHARGES_DRAWN'], color=thunder_orange)\nplt.axhline(league_hustle_data['CHARGES_DRAWN'].mean(), linestyle = \"--\", color=thunder_yellow)\nplt.title(\"Charges Drawn Per Game\")\nplt.xticks(rotation=90)\nplt.show()\n\n\n\n\n\n\n\n\nThis plot is a bit mind bending to look at. The Thunder draw, on average, 1.02 charges per game! The rest of the league averages just over one every three games, with the league-wide average at 0.34 charges per game.\nThis Z-Test visualization really demonstrates just how great the Thunder are in this regard.\n\nfrom statsmodels.stats.weightstats import ztest\nfrom scipy.stats import norm\nimport numpy as np\n\nztest_score, p_val = ztest(thunder_hustle_data['CHARGES_DRAWN'], league_hustle_data['CHARGES_DRAWN'])\n\n# Get mean and stdev\nmean = league_hustle_data['CHARGES_DRAWN'].mean()\nstd = league_hustle_data['CHARGES_DRAWN'].std()\n\n# Create points for the normal distribution curve\nx = np.linspace(league_hustle_data['CHARGES_DRAWN'].min(), league_hustle_data['CHARGES_DRAWN'].max(), 100)\ny = norm.pdf(x, mean, std)\n\n# Scale the bell curve to martch dist\nhist_heights, _ = np.histogram(league_hustle_data['CHARGES_DRAWN'], bins=15)\nscaling_factor = max(hist_heights) / max(y)\ny = y * scaling_factor\n\nplt.figure(figsize=(10, 6))\nsns.histplot(data=league_hustle_data['CHARGES_DRAWN'], bins=15, color=thunder_blue)\nplt.plot(x, y, color=thunder_yellow, linestyle='--', alpha=0.8, label='Theoretical Normal Distribution')\nplt.axvline(thunder_hustle_data['CHARGES_DRAWN'][0], color=thunder_orange, linewidth=4, label='Thunder')\n\nplt.title('Z-Test Visualization of Charges Drawn', pad=20)\nplt.xlabel('Charges Drawn per Game')\nplt.ylabel('Number of Teams')\nplt.legend()\n\n# Add annotation showing z-score\nplt.annotate(f'Z-score: {ztest_score:.2f}\\np-value: {p_val:.2e}',\n            xy=(.65, .9), xycoords='axes fraction',\n            bbox=dict(facecolor='white', alpha=0.8))\n\nplt.show()\n\n\n\n\n\n\n\n\nThat is a monstorous gap between Oklahoma City and the rest of the NBA. It’s really impossible to overstate just how good the Thunder are at drawing offensive fouls."
  },
  {
    "objectID": "posts/a-look-at-the-thunder-defense/a-look-at-the-thunder-defense.html#conclusion",
    "href": "posts/a-look-at-the-thunder-defense/a-look-at-the-thunder-defense.html#conclusion",
    "title": "A Look at the Thunder Defense",
    "section": "Conclusion",
    "text": "Conclusion\nOklahoma City are bucking the trend of the rest of the NBA right now - focusing in on defense while the rest of the league is trying to optimize their offenses.\nThe Thunder cause mayhem for teams just trying to get into their offense. If their opponents are fortunate enough to get a shot off, very rarely is the look what would normall be considered good.\nThis team just plain hustles, and I am grateful that we have the opportunity to more deeply appreciate their greatness. In times gone by, these statistics are things that coaches would harp about, but they fell into the category of “intangibles that don’t show up in the box score”. Today, they do show up. Not just in boxscores, but in the win/loss columns and this effort has the Thunder in prime position to make a run at an NBA championship."
  }
]